<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analytics Dashboard</title>
    <link rel="stylesheet" href="/App_Plugins/AnalyticsDashboard/analyticsDashboard.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.0/chart.min.js"></script>
</head>
<div class="dashboard-container" ng-controller="AnalyticsDashboardController as vm">
    <h1 class="dashboard-title">Analytics Dashboard</h1>

    <div class="date-picker-container">
        <div class="date-picker-group">
            <label class="date-picker-label">Start Date</label>
            <input type="date" class="date-picker-input" ng-model="vm.dateFilter.startDate">
        </div>
        <div class="date-picker-group">
            <label class="date-picker-label">End Date</label>
            <input type="date" class="date-picker-input" ng-model="vm.dateFilter.endDate">
        </div>
        <button class="update-button" ng-click="vm.loadPageViews()">Update</button>
    </div>

    <div class="filter-container">
        <div class="filter-group">
            <label class="filter-label">Filter by URL:</label>
            <select class="filter-input" ng-model="vm.selectedUrl" ng-options="url for url in vm.uniqueUrls" ng-change="vm.applyFilters()"></select>
        </div>
    </div>

    <div class="toggle-container">
        <label class="toggle-label">
            <input type="checkbox" ng-model="vm.showPerPageViewsInTable" ng-change="vm.applyFilters()">
            Show Per-Page Views in Table
        </label>
        <label class="toggle-label">
            <input type="checkbox" ng-model="vm.showDailyTotalsInTable" ng-change="vm.applyFilters()">
            Show Daily Totals in Table
        </label>
        <label class="toggle-label">
            <input type="checkbox" ng-model="vm.showPerPageOverallTotals" ng-change="vm.applyFilters()">
            Show Per-Page Overall Totals
        </label>
        <label class="toggle-label">
            <input type="checkbox" ng-model="vm.showAllPagesOverallTotal" ng-change="vm.applyFilters()">
            Show All Pages Overall Total
        </label>
        <label class="toggle-label">
            <input type="checkbox" ng-model="vm.showGraph" ng-change="vm.updateChart()">
            Show Graph
        </label>
    </div>

    <div class="chart-container" ng-show="vm.showGraph">
        <h2 class="chart-title">Page Views Chart</h2>
        <div style="position: relative; height: 400px;">
            <canvas id="pageViewsChart"></canvas>
        </div>
    </div>

    <div class="table-container">
        <h2 class="chart-title">Detailed Page Views</h2>
        <table class="data-table">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>URL</th>
                    <th>Views</th>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="view in vm.filteredPageViews">
                    <td>{{view.date}}</td>
                    <td>{{view.url}}</td>
                    <td>{{view.views}}</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>